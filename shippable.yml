language: ruby
rvm:
  - ruby-2.2.1
cache: bundler
archive: true
env:
  global:
    - secure: l8XmBtlTZlGhr4eiWfYc9WGRydABMaHrW6lGeuW/LSNrRndIHqtKlIA5XNWr/6Oo89KV2KMcskbqjgwgamAgkCQ5LPRjRQCI4Az36cre7dPFFPKd7UXZXKKNSif8JSBAEnp0gzLgvGzl2fXD7xtFciqVaSjq4UCmcjlRT/MpJma15tJtqVmTK1PGcprqrLbT8jl5Iaq5IARhLCdqJwDQrIcsL5NJDmvhH/jhJoosMmsS6xWxN2eajgQ/spf30/9LpjJbz7t3S29dDSHDPvjWyqfisss05dYVfMrdVwyl7GkmoDTAC2dbibCmqtMVT8vKa7DLGmfMSVN+oxZJUJAYkA==
services:
  - postgres
notifications:
   email: false
build:
  ci:
    - sudo apt-get -y update
    - sudo apt-get -y install libpq-dev
    - sudo apt-get install imagemagick libmagickcore-dev libmagickwand-dev
    - bundle install
    - psql -c 'DROP DATABASE IF EXISTS "space10-test";' -U postgres
    - psql -c 'CREATE DATABASE "space10-test";' -U postgres
    - cp config/database.shippable.yml config/database.yml
    - RAILS_ENV=test bundle exec rake db:schema:load
    - bundle exec rspec
